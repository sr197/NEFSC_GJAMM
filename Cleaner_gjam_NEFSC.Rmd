---
title: "cleaner GJAM"
author: "Sarah Roberts"
date: "3/30/2019"
output: html_document
---

```{r packages, include=FALSE}
library(gjam)
library(tidyr)#data manipulation
library(dplyr) #data manipulation
library(naniar) #replace with NA
```

#Load data 
```{r load data}
#okay we need to start from scratch because some of the bratt stuff was wonky (there were no species names after the letter M)
#first I am going to load the original spring and fall data
#then make in a workable format 

#load data 
fall_catch <- read.csv("~/Documents/ClimateOceanPlanning/Datasets/NEFSC_Bottom_Trawl/22560_FSCSTables_Fall/22560_UNION_FSCS_SVCAT.csv")
fall_x <- read.csv("~/Documents/ClimateOceanPlanning/Datasets/NEFSC_Bottom_Trawl/22560_FSCSTables_Fall/22560_UNION_FSCS_SVSTA.csv")

spring_catch <- read.csv("~/Documents/ClimateOceanPlanning/Datasets/NEFSC_Bottom_Trawl/22561_FSCSTables_spring/22561_UNION_FSCS_SVCAT.csv")
spring_x <- read.csv("~/Documents/ClimateOceanPlanning/Datasets/NEFSC_Bottom_Trawl/22561_FSCSTables_spring/22561_UNION_FSCS_SVSTA.csv")

```

```{r data manip}
#manipulated the catch data to be in tidy format 
fall_catch <- fall_catch %>% 
 group_by_at(vars(-expcatchnum)) %>% # group by everything other than the value column. 
 mutate(row_id=1:n()) %>% ungroup() %>% # build group index
 spread(key=scientific_name, value=expcatchnum)  # spread

fall_catch$id <- as.numeric(as.character(fall_catch$id))

fall_catch_select <- fall_catch %>% 
  select(-catch_comment) %>% 
  mutate_if(is.factor, as.integer) %>% 
  group_by(id) %>% 
  replace(is.na(.), 0) %>%
 summarise_each(funs(max)) 

fall_catch_select <- fall_catch_select %>% 
  select(-status_code, -svspp, -catchsex, -expcatchwt, -row_id)

#joining the tables 
fall_x$id <- as.numeric(as.character(fall_x$id))
fall <- left_join(fall_catch_select, fall_x, by="id")
fall$season <- "fall"

#doing the same for spring 
spring_catch <- spring_catch %>% 
 group_by_at(vars(-expcatchnum)) %>% # group by everything other than the value column. 
 mutate(row_id=1:n()) %>% ungroup() %>% # build group index
 spread(key=scientific_name, value=expcatchnum)  # spread

spring_catch$id <- as.numeric(as.character(spring_catch$id))

spring_catch_select <- spring_catch %>% 
  select(-catch_comment) %>% 
  mutate_if(is.factor, as.integer) %>% 
  group_by(id) %>% 
  replace(is.na(.), 0) %>%
 summarise_each(funs(max)) 

spring_catch_select <- spring_catch_select %>% 
  select(-status_code, -svspp, -catchsex, -expcatchwt, -row_id)

#joining the tables 
spring_x$id <- as.numeric(as.character(spring_x$id))
spring <- left_join(spring_catch_select, spring_x, by="id")
spring$season <- "spring"

#combining spring and fall 
#first lets select only the overlapping species/columns 
cols <- intersect(colnames(spring), colnames(fall))
total <- rbind(spring[,cols], fall[,cols])

#now need to filter for the data after 1982 (this is when Batt uses it. There was a change in otter doors to allow more pelagics, and more consistent sampling of southern stratum) http://www.ices.dk/sites/pub/CM%20Doccuments/1997/Y/1997_Y33.pdf

total <- total %>% 
  filter(est_year>1981)

total_latlondate <- total %>% 
  select(id, decdeg_beglat, decdeg_beglon, est_year, est_month)

write.csv(total_latlondate, file="latlondate_total.csv")

```
Now I need to go back and make a few files. The first one is the NAO/AMO file which is located in the longlatdat_total xl file. Use the index function to get the NAO/AMO values by year. 

The next step is to go in and copy the long lat file to arcmap and use that and the benthic habitat poly 2 shapefile along with the IDENTITY tool to get all of the information into one. 



```{r Adding external data}
#adding AMO/NAO and habitat information 
climate_vars <- read.csv("~/Documents/ClimateOceanPlanning/R/NEFSC_GJAMM_GIT/NAO_AMO_dat.csv")
hab_vars <- read.csv("~/Documents/ClimateOceanPlanning/R/NEFSC_GJAMM_GIT/habitat_dat.csv")

total <- rbind(spring[,cols], fall[,cols])
total <- total %>% 
  filter(est_year>1981)
#remove id's where NA 
total <- total %>% 
  filter(!is.na(id)) 

total <- total %>% 
  filter(!is.na(beglat)) #idk why there was a spatial NA but got rid of it in the other files and here #note this is really frustrating and can't figure out that the id columns are the same so I might just do it in excel 
#note this id is missing spatial points 
#201204013400080000.00


#bind them all together 
total <- cbind(total, climate_vars, by="id")

total <- cbind(total, hab_vars, by="id", all=T)

#getting rid of some overlapping columns 
total <- total[, !duplicated(colnames(total))]



#trimming so just the columns we want 

xdata <- total %>% 
 select(id, est_month, est_day, est_year,surftemp, surfsalin, bottemp,
     botsalin, AMO_unsm_month, AMO_unsm_year, NAO_month, NAO_year, NAO_JFM, avgdepth,
     LPI, SLOPE, SBF_GRP, SBFDEPTH, SEDIMENT, SBFDESED, BENHAB, decdeg_beglat, decdeg_beglon)

#lets also add a column for sediment type 
xdata$SED_TYPE <- ifelse(xdata$SEDIMENT ==  '0 - 0.03 Silt/Mud', 'Silt/Mud', 
                        ifelse(xdata$SEDIMENT ==  '0.03 - 0.17 Sand', 'Sand',
                               ifelse(xdata$SEDIMENT ==  '0.17 - 0.35 Sand', 'Sand', 
                                      ifelse(xdata$SEDIMENT ==  '0.35 - 0.36 Sand', 'Sand',
                                             ifelse(xdata$SEDIMENT ==  '0.36 - 0.48 Sand', 'Sand',
                                                    ifelse(xdata$SEDIMENT ==  '20.03 - 0.17 Sand',
                                                           'Sand',
                                                    ifelse(xdata$SEDIMENT ==  '0.48+ Coarse Sand to  
                                                           Gravel','Gravel', 
                                                           ifelse(xdata$SEDIMENT ==  '60.48+ Coarse 
                                                                  Sand to Gravel',
                                                                  'Gravel', NA))))))))
xdata$SED_TYPE <- ifelse(xdata$SEDIMENT ==  '0.48+ Coarse Sand to Gravel','Gravel', ifelse(xdata$SEDIMENT ==  '60.48+ Coarse Sand to Gravel', 'Gravel', xdata$SED_TYPE))
#weirdly have to do this in two steps, I think it doesnt like too many if else statements oh well. 

#too many to do like this for ydata so will just select the columns 
ydata <- total[,7:513]
```
#checkpoint 
do we have adataset by ID with all of the x and y data as well as a dataset with just x data and just y data? 


#selecting species 
So I could go a couple of ways here. I could follow Batt 2017 which selected a number of species, or I could go on my own and select species that are present in a lot of the trawls. I am going to do the latter first.

```{r selecting species, include=FALSE}
#splitting into x and ydata 

ycommon <- gjamTrimY(ydata, 100, OTHER=F)$y

```


#running GJAM 
splitting into chunks 

```{r}
total_data <- cbind(ycommon,xdata)


#first time chunk 
total <- subset(total_data, est_year < 2000)
ydata <- total[,1:197]
ydata[is.na(ydata)] <- 0
ycommon <- gjamTrimY(ydata, 100, OTHER=F)$y
#need to do this here to see ones that werent caught early and are caught later 

xdata <- total %>% 
 select(id, est_month, est_day, est_year,surftemp, surfsalin, bottemp,
     botsalin, AMO_unsm_month, AMO_unsm_year, NAO_month, NAO_year, NAO_JFM, avgdepth,
     LPI, SLOPE, SBF_GRP, SBFDEPTH, SEDIMENT, SBFDESED, BENHAB, decdeg_beglat, decdeg_beglon,
     SED_TYPE)

S <- ncol(ycommon)
ml <- list(ng = 10000, burnin = 2000, typeNames = 'DA')



xdata <- as.data.frame(xdata)
xdata$GRPSED <- as.factor(as.character(xdata$SEDIMENT))
xdata$SED_TYPE <- as.factor(as.character(xdata$SED_TYPE))
xdata$est_year <- as.factor(xdata$est_year)
xdata$AMO_unsm <- as.numeric(as.character(xdata$AMO_unsm_year))
xdata$avgdepth <- as.numeric(xdata$avgdepth)
xdata$surfsalin <- as.numeric(xdata$botsalin)
xdata$bottemp <- as.numeric(xdata$bottemp)
xdata$NAO <- as.numeric(as.character((xdata$NAO_year)))


out <- gjam(~ avgdepth + bottemp + botsalin + AMO_unsm_year + NAO_year + SED_TYPE, xdata, ycommon, modelList = ml)


save(out, file='out_82_99.Rdata')
load('out_82_99.Rdata')
plotPars <- list(SMALLPLOTS = T, GRIDPLOTS=T)
gjamPlot(out, plotPars=plotPars)

#get informative stuff and save 
DIC_1 <- out$fit$DIC         # DIC
rmspe_1 <- out$fit$rmspeAll    # root mean squared prediction error for all species
rmspe_spec_1 <- out$fit$rmspeBySpec # RMSPE for each species

VIF_1 <- out$inputs$designTable               # VIF for each predictor
beta_1 <- out$parameters$betaMu                # mean beta for each species and predictor
cred_1 <- out$parameters$betaStandXTable # credible interval for each species and predictor
sens_1 <- out$parameters$sensTable             # sensitivity


#lets try and get out only the significant betas 
#need to add a column with the specnames in it because right now its just the row names 
cred_1$names <- rownames(cred_1)

cred_1_sig <- cred_1 %>% 
  filter(sig95 == "*")

```


#second time chunk
```{r}
#second time chunk 
total <- subset(total_data, est_year > 1999)
ydata <- total[,1:197]
ydata[is.na(ydata)] <- 0
ycommon <- gjamTrimY(ydata, 100, OTHER=F)$y
#need to do this here to see ones that werent caught early and are caught later 

xdata <- total %>% 
 select(id, est_month, est_day, est_year,surftemp, surfsalin, bottemp,
     botsalin, AMO_unsm_month, AMO_unsm_year, NAO_month, NAO_year, NAO_JFM, avgdepth,
     LPI, SLOPE, SBF_GRP, SBFDEPTH, SEDIMENT, SBFDESED, BENHAB, decdeg_beglat, decdeg_beglon,
     SED_TYPE)

S <- ncol(ycommon)
ml <- list(ng = 10000, burnin = 2000, typeNames = 'DA')



xdata <- as.data.frame(xdata)
xdata$GRPSED <- as.factor(as.character(xdata$SEDIMENT))
xdata$SED_TYPE <- as.factor(as.character(xdata$SED_TYPE))
xdata$est_year <- as.factor(xdata$est_year)
xdata$AMO_unsm <- as.numeric(as.character(xdata$AMO_unsm_year))
xdata$avgdepth <- as.numeric(xdata$avgdepth)
xdata$surfsalin <- as.numeric(xdata$botsalin)
xdata$bottemp <- as.numeric(xdata$bottemp)
xdata$NAO <- as.numeric(as.character((xdata$NAO_year)))


out <- gjam(~ avgdepth + bottemp + botsalin + AMO_unsm_year + NAO_year + SED_TYPE, xdata, ycommon, modelList = ml)


save(out, file='out_99_15.Rdata')
load('out_99_15.Rdata')
plotPars <- list(SMALLPLOTS = T, GRIDPLOTS=T)
gjamPlot(out, plotPars=plotPars)

#getting informative stuff 
out$parameters$fSe
out$fit$DIC
gp <- gjamPlot(output = out, plotPars = plotPars)
gp$clusterIndex
#There are three versions, data, E, and R that correspond to plots that come out. E = environmental response, R = residual covariance

DIC_2 <- out$fit$DIC         # DIC
rmspe_2 <- out$fit$rmspeAll    # root mean squared prediction error for all species
rmspe_spec_2 <- out$fit$rmspeBySpec # RMSPE for each species

VIF_2 <- out$inputs$designTable               # VIF for each predictor
beta_2 <- out$parameters$betaMu                # mean beta for each species and predictor
cred_2 <- out$parameters$betaStandXTable # credible interval for each species and predictor
sens_2 <- out$parameters$sensTable             # sensitivity

#head(out$prediction$presence)        # predicted occurance for each species


#lets try and get out only the significant betas 
#need to add a column with the specnames in it because right now its just the row names 
cred_2$names <- rownames(cred_2)

cred_2_sig <- cred_2 %>% 
  filter(sig95 == "*")
```


```{r}
#all data
total <- total_data
ydata <- total[,1:197]
ydata[is.na(ydata)] <- 0
ycommon <- gjamTrimY(ydata, 100, OTHER=F)$y
#need to do this here to see ones that werent caught early and are caught later 

xdata <- total %>% 
 select(id, est_month, est_day, est_year,surftemp, surfsalin, bottemp,
     botsalin, AMO_unsm_month, AMO_unsm_year, NAO_month, NAO_year, NAO_JFM, avgdepth,
     LPI, SLOPE, SBF_GRP, SBFDEPTH, SEDIMENT, SBFDESED, BENHAB, decdeg_beglat, decdeg_beglon,
     SED_TYPE)

S <- ncol(ycommon)
ml <- list(ng = 10000, burnin = 2000, typeNames = 'DA')



xdata <- as.data.frame(xdata)
xdata$GRPSED <- as.factor(as.character(xdata$SEDIMENT))
xdata$SED_TYPE <- as.factor(as.character(xdata$SED_TYPE))
xdata$est_year <- as.factor(xdata$est_year)
xdata$AMO_unsm <- as.numeric(as.character(xdata$AMO_unsm_year))
xdata$avgdepth <- as.numeric(xdata$avgdepth)
xdata$surfsalin <- as.numeric(xdata$botsalin)
xdata$bottemp <- as.numeric(xdata$bottemp)
xdata$NAO <- as.numeric(as.character((xdata$NAO_year)))


out <- gjam(~ avgdepth + bottemp + botsalin + AMO_unsm_year + NAO_year + SED_TYPE, xdata, ycommon, modelList = ml)


save(out, file='out_82_15.Rdata')
plotPars <- list(SMALLPLOTS = T, GRIDPLOTS=T)
gjamPlot(out, plotPars=plotPars)

```

#"ATLANTOPANDALUS.PROPINQVUS","CANCER.PLEBEJUS", "CHACEON.QUINQUEDENS",
#need to fix this because some things are spelled incorrectly etc 
#specnames from Batt 2017
# `Atlantopandalus propinqvus`, `Hippoglossoides platessoides`,`Hippoglossina oblonga`, `Leptoclinus maculatus`, `Lopholatilus chamaeleonticeps`, `Lumpenus lampretaeformis`, `Lycenchelys verrillii`, `Macrorhamphosus scolopax`, 
ydata <- ydata %>% 
   select(`Acipenser oxyrinchus`, `Alosa aestivalis`, `Alosa pseudoharengus`, `Alosa sapidissima`, `Amblyraja radiata`, `Ammodytes dubius`, `Anarhichas lupus`, `Anchoa hepsetus`, `Anchoa mitchilli`, `Antigonia capros`, `Argentina silus`, `Argentina striata`, `Aspidophoroides monopterygius`,`Bairdiella chrysoura`, `Bathynectes longispina`, `Bathypolypus arcticus`, `Brevoortia tyrannus`, `Brosme brosme`, `Cancer borealis`, `Cancer plebejus`, `Carcharhinus plumbeus`, `Centropristis philadelphica`, `Centropristis striata`, `Chaceon quinquedens`, `Chionoecetes opilio`, `Chlorophthalmus agassizi`, `Citharichthys arctifrons`, `Clupea harengus`, `Conger oceanicus`, `Crangon septemspinosa`, `Cryptacanthodes maculatus`, `Cyclopterus lumpus`, `Cynoscion regalis`, `Dasyatis centroura`, `Dasyatis say`, `Decapterus punctatus`, `Dichelopandalus leptocerus`, `Dipturus laevis`, `Enchelyopus cimbrius`, `Etropus microstomus`, `Etrumeus teres(sadina)`, `Foetorepus agassizii`, `Gadus morhua`, `Glyptocephalus cynoglossus`, `Gymnura altavela`, `Helicolenus dactylopterus`, `Hemitripterus americanus`, `Hippoglossus hippoglossus`, `Homarus americanus`, `Illex illecebrosus`, `Lagodon rhomboides`, `Larimus fasciatus`, `Lebbeus polaris`, `Leiostomus xanthurus`, `Lepophidium profundorum`, `Leucoraja erinacea`, `Leucoraja garmani`, `Leucoraja ocellata`, `Limanda ferruginea`, `Limulus polyphemus`, `Liparis atlanticus`, `Lithodes maja`, `Loligo pealeii`, `Lolliguncula brevis`, `Lophius americanus`, `Malacoraja senta`, `Maurolicus weitzmani`, `Melanogrammus aeglefinus`, `Melanostigma atlanticum`, `Menidia menidia`, `Menticirrhus americanus`, `Menticirrhus saxatilis`, `Merluccius albidus`, `Merluccius bilinearis`, `Micropogonias undulatus`, `Monolene sessilicauda`, `Morone saxatilis`, `Mustelus canis`, `Myliobatis freminvillii`, `Myoxocephalus aenaeus`, `Myoxocephalus octodecemspinosus`, `Myxine glutinosa`, `Nemichthys scolopaceus`, `Ophidion marginatum`, `Osmerus mordax`, `Ovalipes ocellatus`, `Ovalipes stephensoni`, `Pandalus borealis`, `Pandalus montagui`, `Paralichthys dentatus`, `Parasudis truculenta`, `Pasiphaea multidentata`, `Peprilus triacanthus`, `Peristedion miniatum`, `Petromyzon marinus`, `Phycis chesteri`, `Placopecten magellanicus`, `Pollachius virens`, `Polymixia lowei`, `Pomatomus saltatrix`, `Pontinus longispinis`, `Pontophilus norvegicus`, `Prionotus alatus`, `Prionotus carolinus`, `Prionotus evolans`, `Pseudopleuronectes americanus`, `Raja eglanteria`, `Scomber scombrus`, `Scophthalmus aquosus`, `Scyliorhinus retifer`, `Sebastes fasciatus`, `Sicyonia brevirostris`, `Squalus acanthias`, `Squatina dumeril`, `Stenotomus chrysops`, `Syacium papillosum`, `Symphurus plagiusa`, `Synagrops bellus`, `Syngnathus fuscus`, `Synodus foetens`, `Synodus poeyi`, `Tautogolabrus adspersus`, `Trachinocephalus myops`, `Trachurus lathami`, `Trichiurus lepturus`, `Triglops murrayi`, `Trinectes maculatus`, `Ulvaria subbifurcata`, `Urophycis chuss`, `Urophycis regia`, `Urophycis tenuis`, `Zenopsis conchifera`, `Zoarces americanus`)


specNames <- c("ACIPENSER.OXYRYNCHUS"`, `"ALOSA.AESTIVALIS", "ALOSA.PSEUDOHARENGUS", "ALOSA.SAPIDISSIMA", "AMBLYRAJA.RADIATA", "AMMODYTES.DUBIUS", "ANARHICHAS.LUPUS", "ANCHOA.HEPSETUS", "ANCHOA.MITCHILLI", "ANTIGONIA.CAPROS", "ARGENTINA.SILUS", "ARGENTINA.STRIATA", "ASPIDOPHOROIDES.MONOPTERYGIUS", "BAIRDIELLA.CHRYSOURA", "BATHYNECTES.LONGISPINA", "BATHYPOLYPUS.ARCTICUS", "BREVOORTIA.TYRANNUS", "BROSME.BROSME", "CANCER.BOREALIS", "CARCHARHINUS.PLUMBEUS", "CENTROPRISTIS.PHILADELPHICA", "CENTROPRISTIS.STRIATA", "CHIONOECETES.OPILIO", "CHLOROPHTHALMUS.AGASSIZI", "CITHARICHTHYS.ARCTIFRONS", "CLUPEA.HARENGUS", "CONGER.OCEANICUS", "CRANGON.SEPTEMSPINOSA", "CRYPTACANTHODES.MACULATUS", "CYCLOPTERUS.LUMPUS", "CYNOSCION.REGALIS", "DASYATIS.CENTROURA", "DASYATIS.SAY", "DECAPTERUS.PUNCTATUS", "DICHELOPANDALUS.LEPTOCERUS", "DIPTURUS.LAEVIS", "ENCHELYOPUS.CIMBRIUS", "ETROPUS.MICROSTOMUS", "ETRUMEUS.TERES", "FOETOREPUS.AGASSIZII", "GADUS.MORHUA", "GLYPTOCEPHALUS.CYNOGLOSSUS", "GYMNURA.ALTAVELA", "HELICOLENUS.DACTYLOPTERUS", "HEMITRIPTERUS.AMERICANUS", "HIPPOGLOSSINA.OBLONGA", "HIPPOGLOSSOIDES.PLATESSOIDES", "HIPPOGLOSSUS.HIPPOGLOSSUS", "HOMARUS.AMERICANUS", "ILLEX.ILLECEBROSUS", "LAGODON.RHOMBOIDES", "LARIMUS.FASCIATUS", "LEBBEUS.POLARIS", "LEIOSTOMUS.XANTHURUS", "LEPOPHIDIUM.PROFUNDORUM", "LEPTOCLINUS.MACULATUS", "LEUCORAJA.ERINACEA", "LEUCORAJA.GARMANI", "LEUCORAJA.OCELLATA", "LIMANDA.FERRUGINEA", "LIMULUS.POLYPHEMUS", "LIPARIS.ATLANTICUS", "LITHODES.MAJA", "LOLIGO.PEALEII", "LOLLIGUNCULA.BREVIS", "LOPHIUS.AMERICANUS", "LOPHOLATILUS.CHAMAELEONTICEPS", "LUMPENUS.LAMPRETAEFORMIS", "LYCENCHELYS.VERRILLII", "MACRORHAMPHOSUS.SCOLOPAX", "MALACORAJA.SENTA", "MAUROLICUS.WEITZMANI", "MELANOGRAMMUS.AEGLEFINUS", "MELANOSTIGMA.ATLANTICUM", "MENIDIA.MENIDIA", "MENTICIRRHUS.AMERICANUS", "MENTICIRRHUS.SAXATILIS", "MERLUCCIUS.ALBIDUS", "MERLUCCIUS.BILINEARIS", "MICROPOGONIAS.UNDULATUS", "MONOLENE.SESSILICAUDA", "MORONE.SAXATILIS", "MUSTELUS.CANIS", "MYLIOBATIS.FREMINVILLII", "MYOXOCEPHALUS.AENAEUS", "MYOXOCEPHALUS.OCTODECEMSPINOSUS", "MYXINE.GLUTINOSA", "NEMICHTHYS.SCOLOPACEUS", "OPHIDION.MARGINATUM", "OSMERUS.MORDAX", "OVALIPES.OCELLATUS", "OVALIPES.STEPHENSONI", "PANDALUS.BOREALIS", "PANDALUS.MONTAGUI", "PARALICHTHYS.DENTATUS", "PARASUDIS.TRUCULENTA", "PASIPHAEA.MULTIDENTATA", "PEPRILUS.TRIACANTHUS", "PERISTEDION.MINIATUM", "PETROMYZON.MARINUS")

specNames <- c("PHYCIS.CHESTERI", "PLACOPECTEN.MAGELLANICUS", "POLLACHIUS.VIRENS", "POLYMIXIA.LOWEI", "POMATOMUS.SALTATRIX", "PONTINUS.LONGISPINIS", "PONTOPHILUS.NORVEGICUS", "PRIONOTUS.ALATUS", "PRIONOTUS.CAROLINUS", "PRIONOTUS.EVOLANS", "PSEUDOPLEURONECTES.AMERICANUS", "RAJA.EGLANTERIA", "SCOMBER.SCOMBRUS", "SCOPHTHALMUS.AQUOSUS", "SCYLIORHINUS.RETIFER", "SEBASTES.FASCIATUS", "SICYONIA.BREVIROSTRIS", "SQUALUS.ACANTHIAS", "SQUATINA.DUMERIL", "STENOTOMUS.CHRYSOPS", "SYACIUM.PAPILLOSUM", "SYMPHURUS.PLAGIUSA", "SYNAGROPS.BELLUS", "SYNGNATHUS.FUSCUS", "SYNODUS.FOETENS", "SYNODUS.POEYI", "TAUTOGOLABRUS.ADSPERSUS", "TRACHINOCEPHALUS.MYOPS", "TRACHURUS.LATHAMI", "TRICHIURUS.LEPTURUS", "TRIGLOPS.MURRATRINECTES.MACULATUS", "ULVARIA.SUBBIFURCATA", "UROPHYCIS.CHUSS", "UROPHYCIS.REGIA", "UROPHYCIS.TENUIS", "ZENOPSIS.CONCHIFERA", "ZOARCES.AMERICANUS")

specNames <- c(spec1, spec2)

xnames <- c("year", "depth", "btemp", "ssalin", "AMO_unsm_month", "NAO_month", "NAO_JFM", "BATHYMETRY", "SBF_GRP", "SEDIMENT")

ydata <- bioandcatch[,specNames]
xdata <- bioandcatch[,xnames]

```

